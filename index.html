<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse Consommation Tempo</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Analyse de Consommation √âlectrique Tempo</h1>
        </header>

        <div class="upload-section">
            <label for="fileInput">Import du fichier mes-index-elec-xxxxxxxxxxxx-codepostal.csv</label>
            <input type="file" id="fileInput" accept=".csv" />
            <div id="currentFileName" class="current-file-name"></div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Analyse en cours...</p>
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <div id="results" class="results" style="display: none;">
            <div class="controls-section">
                <div class="year-carousel" id="yearCarousel" style="display: none;">
                    <button class="carousel-btn" id="prevYear">‚Äπ</button>
                    <div class="year-display" id="yearDisplay">2024</div>
                    <button class="carousel-btn" id="nextYear">‚Ä∫</button>
                </div>
                
                <div class="subscription-selector">
                    <label for="subscriptionType">Type d'abonnement :</label>
                    <select id="subscriptionType">
                        <option value="6">6 kVA</option>
                        <option value="9">9 kVA</option>
                    </select>
                </div>
            </div>
            
            <div id="bestOfferSummary" class="comparison-summary" style="display: none;">
                <div class="comparison-icon" id="bestOfferIcon">üèÜ</div>
                <div class="comparison-content">
                    <h3 id="bestOfferTitle">Meilleure Offre pour Vous</h3>
                    <p class="comparison-message" id="bestOfferMessage"></p>
                    <div class="comparison-details">
                        <div class="comparison-detail" style="grid-column: 1 / -1;">
                            <span class="comparison-label">Offre recommand√©e :</span>
                            <span class="comparison-value" id="bestOfferName">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="marketComparison" class="market-comparison" style="display: none;">
                <h2>üìä Comparaison avec les Offres HP / HC du March√©</h2>
                <div class="table-wrapper">
                    <table id="comparisonTable">
                        <thead>
                            <tr>
                                <th>Fournisseur</th>
                                <th>Offre</th>
                                <th>D√©tail des Calculs</th>
                                <th>Co√ªt Total</th>
                                <th>Diff√©rence vs Tempo</th>
                            </tr>
                        </thead>
                        <tbody id="comparisonTableBody">
                            <!-- Les lignes seront g√©n√©r√©es dynamiquement -->
                        </tbody>
                    </table>
                </div>
            </div>
            
 <div class="summary-cards">
                <div class="card card-detailed card-full-width">
                    <h3>üí∞ Ma Facture Tempo</h3>
                    <p class="value" id="totalCost">0,00 ‚Ç¨</p>
                    
                    <div class="card-details">
                        <div class="detail-section">
                            <h4>D√©tail des Co√ªts par Cat√©gorie</h4>
                            <div class="detail-item">
                                <span class="detail-label">üîµ Heures Pleines Bleu (0,1612 ‚Ç¨/kWh):</span>
                                <span class="detail-value" id="bleuHPCost">0,00 ‚Ç¨</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üîµ Heures Creuses Bleu (0,1325 ‚Ç¨/kWh):</span>
                                <span class="detail-value" id="bleuHCCost">0,00 ‚Ç¨</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">‚ö™ Heures Pleines Blanc (0,1871 ‚Ç¨/kWh):</span>
                                <span class="detail-value" id="blancHPCost">0,00 ‚Ç¨</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">‚ö™ Heures Creuses Blanc (0,1499 ‚Ç¨/kWh):</span>
                                <span class="detail-value" id="blancHCCost">0,00 ‚Ç¨</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üî¥ Heures Pleines Rouge (0,7060 ‚Ç¨/kWh):</span>
                                <span class="detail-value" id="rougeHPCost">0,00 ‚Ç¨</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üî¥ Heures Creuses Rouge (0,1575 ‚Ç¨/kWh):</span>
                                <span class="detail-value" id="rougeHCCost">0,00 ‚Ç¨</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="summary-cards">
                <div class="card card-detailed">
                    <h3>Consommation Totale</h3>
                    <p class="value" id="totalConsumption">0 kWh</p>
                    
                    <div class="card-details">
                        <div class="detail-section">
                            <h4>D√©tail par Couleur et P√©riode</h4>
                            <div class="detail-item">
                                <span class="detail-label">üîµ Heures Pleines Bleu:</span>
                                <span class="detail-value" id="bleuHPTotal">0 kWh</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üîµ Heures Creuses Bleu:</span>
                                <span class="detail-value" id="bleuHCTotal">0 kWh</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">‚ö™ Heures Pleines Blanc:</span>
                                <span class="detail-value" id="blancHPTotal">0 kWh</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">‚ö™ Heures Creuses Blanc:</span>
                                <span class="detail-value" id="blancHCTotal">0 kWh</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üî¥ Heures Pleines Rouge:</span>
                                <span class="detail-value" id="rougeHPTotal">0 kWh</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">üî¥ Heures Creuses Rouge:</span>
                                <span class="detail-value" id="rougeHCTotal">0 kWh</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card card-summary">
                    <h3>R√©partition HP / HC</h3>
                    <div class="hp-hc-summary">
                        <div class="hp-hc-item">
                            <span class="hp-hc-icon">‚òÄÔ∏è</span>
                            <div class="hp-hc-info">
                                <span class="hp-hc-label">Heures Pleines</span>
                                <span class="hp-hc-value" id="hpSummary">0 kWh</span>
                                <span class="hp-hc-percent" id="hpPercent">0%</span>
                            </div>
                        </div>
                        <div class="hp-hc-item">
                            <span class="hp-hc-icon">üåô</span>
                            <div class="hp-hc-info">
                                <span class="hp-hc-label">Heures Creuses</span>
                                <span class="hp-hc-value" id="hcSummary">0 kWh</span>
                                <span class="hp-hc-percent" id="hcPercent">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
           

            <div class="chart-section">
                <h2>R√©partitions de Consommation</h2>
                <div class="charts-row">
                    <div class="chart-container">
                        <canvas id="periodPieChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="hpHcPieChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-section">
                <h2>R√©partition Mensuelle</h2>
                <div class="chart-container-full">
                    <canvas id="monthlyBarChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="market.js"></script>
    <script src="app.js"></script>
</body>
</html>
